<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="3.24" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" ReportOptions.CreateDate="37872,4673897222" ReportOptions.Description.Text="" ReportOptions.LastChange="38376,7590353472" ScriptLanguage="PascalScript" ScriptText.Text="procedure Page2OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page2, Engine do&#13;&#10;  begin&#13;&#10;  edAno.Text    := [[YEAROF([DATE])] - 1];&#13;&#10;  edMes.Text    := '00';&#13;&#10;  ComboBox.ItemIndex := 0;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;  COLPOS                := 0;&#13;&#10;  DETAILFOOTER1.VISIBLE := [cbValor.checked];&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button1, Engine do&#13;&#10;  begin&#13;&#10;  if (ComboBox1.Text = '') then begin&#13;&#10;     messagebox('Selecione o tipo de responsável!', 'Relatório de Funcionário / Empresa');&#13;&#10;     ModalResult := mrNone;&#13;&#10;     exit;&#13;&#10;  end;&#13;&#10;  if (edAno.Text = '') then begin&#13;&#10;     messagebox('Selecione o ano!', 'Relatório de Funcionário / Empresa');&#13;&#10;     ModalResult := mrNone;&#13;&#10;     exit;&#13;&#10;  end;&#13;&#10;  [SIGHAPARAMVALOR(RELOADED, 1)];&#13;&#10;  FUNCIONARIO.OPEN;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button2, Engine do&#13;&#10;  begin&#13;&#10;  [SIGHAPARAMVALOR(RELOADED, 0)];&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;  EMPRESA.CLOSE;&#13;&#10;&#13;&#10;  EMPRESA.SQL.CLEAR;&#13;&#10;  if ComboBox1.Text = 'CONTABILIDADE' then begin&#13;&#10;    EMPRESA.SQL.ADD('SELECT E.ANOMES, ES.NOMERAZAO, (SELECT FIRST 1 VALOR FROM EMPRESAS_HONORARIOS WHERE CODIGOEMPRESA = E.CODIGOEMPRESA AND ANOMES = SUBSTRING(E.ANOMES FROM 1 FOR 4) ORDER BY ANOMES) AS VALOR');&#13;&#10;    EMPRESA.SQL.ADD('FROM EMPRESAS_RESPONSAVEL E, EMPRESAS ES WHERE E.CODIGOEMPRESA = ES.CODIGO AND E.CONTABIL = '''+[FUNCIONARIO.&#34;APELIDO&#34;]+'''');&#13;&#10;  end else begin&#13;&#10;    EMPRESA.SQL.ADD('SELECT E.ANOMES, ES.NOMERAZAO, (SELECT FIRST 1 VALOR FROM EMPRESAS_HONORARIOS WHERE CODIGOEMPRESA = E.CODIGOEMPRESA AND ANOMES = SUBSTRING(E.ANOMES FROM 1 FOR 4) ORDER BY ANOMES) AS VALOR');&#13;&#10;    EMPRESA.SQL.ADD('FROM EMPRESAS_RESPONSAVEL E, EMPRESAS ES WHERE E.CODIGOEMPRESA = ES.CODIGO AND E.FISCAL = '''+[FUNCIONARIO.&#34;APELIDO&#34;]+'''');&#13;&#10;  end;&#13;&#10;&#13;&#10;  if (edMes.Text &#60;&#62; '0') AND (edMes.Text &#60;&#62; '00') then&#13;&#10;    EMPRESA.SQL.ADD('AND E.ANOMES STARTING '''+edAno.Text+'/'+edMes.Text+'''')&#13;&#10;  else&#13;&#10;    EMPRESA.SQL.ADD('AND E.ANOMES STARTING '''+edAno.Text+'''');&#13;&#10;&#13;&#10;  if ComboBox1.Text = 'CONTABILIDADE' then&#13;&#10;    EMPRESA.SQL.ADD('ORDER BY ES.NOMERAZAO')&#13;&#10;  else&#13;&#10;    EMPRESA.SQL.ADD('ORDER BY ES.NOMERAZAO');&#13;&#10;&#13;&#10;  EMPRESA.OPEN;&#13;&#10;  EMPRESA.FETCHALL;&#13;&#10;&#13;&#10;  if EMPRESA.ISEMPTY then begin&#13;&#10;     MasterData1.VISIBLE := False;&#13;&#10;     EXIT;&#13;&#10;  end else begin&#13;&#10;     MasterData1.VISIBLE := True;&#13;&#10;     IF [FREESPACE] &#60;= [[[EMPRESA.RECORDCOUNT] * [DetailData1.HEIGHT]] + [DetailFooter1.HEIGHT]] THEN&#13;&#10;       [NEWCOLUMN()];&#13;&#10;  end;&#13;&#10;end&#13;&#10;  end&#13;&#10;;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DetailData1, Engine do&#13;&#10;  begin&#13;&#10;end&#13;&#10;&#13;&#10;  IF COLPOS &#62; 0 THEN&#13;&#10;    IF [CURY] &#60;= COLPOS THEN&#13;&#10;      [SHOWBAND(masterdata1)];&#13;&#10;  COLPOS := [CURY];&#13;&#10;  end&#13;&#10;;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403A00103546F7003C80008446174617365747301010C3000000020446174615365743D2246554E43494F4E4152494F2220446174615365744E616D653D2246554E43494F4E4152494F2200010C2800000020446174615365743D22454D50524553412220446174615365744E616D653D22454D5052455341220000095661726961626C65730100055374796C650100">
  <TfrxDialogPage Name="Page2" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Relatório de Funcionário / Empresa" Color="-2147483633" Height="155" Left="182" Top="179" Width="318" OnShow="Page2OnShow">
    <TfrxLabelControl Name="Label1" Left="9" Top="15" Width="32" Height="16" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Caption="Ano:" Color="-2147483633"/>
    <TfrxEditControl Name="edAno" Left="8" Top="31" Width="57" Height="21" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxEditControl Name="edMes" Left="76" Top="31" Width="33" Height="21" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label2" Left="77" Top="15" Width="32" Height="16" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Caption="Mês:" Color="-2147483633"/>
    <TfrxLabelControl Name="Label3" Left="120" Top="16" Width="40" Height="16" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Caption="Tipo:" Color="-2147483633"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="120" Top="32" Width="169" Height="21" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-2147483643" Items.Text="CONTABILIDADE&#13;&#10;LIVRO FISCAL" Style="csDropDownList" ItemIndex="-1"/>
    <TfrxIBXQuery Name="FUNCIONARIO" UserName="FUNCIONARIO" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT * FROM FUNCIONARIO&#13;&#10;ORDER BY NOME" PropData="0A506172616D65746572730100"/>
    <TfrxIBXQuery Name="EMPRESA" UserName="EMPRESA" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT E.*, ES.NOMERAZAO,&#13;&#10;(CASE WHEN (SELECT FIRST 1 VALOR FROM EMPRESAS_HONORARIOS WHERE CODIGOEMPRESA = E.CODIGOEMPRESA AND ANOMES = E.ANOMES) IS NULL THEN&#13;&#10;(SELECT FIRST 1 VALOR FROM EMPRESAS_HONORARIOS WHERE CODIGOEMPRESA = E.CODIGOEMPRESA AND ANOMES LIKE SUBSTRING(E.ANOMES FROM 1 FOR 4)||'%' ORDER BY ANOMES) ELSE&#13;&#10;(SELECT FIRST 1 VALOR FROM EMPRESAS_HONORARIOS WHERE CODIGOEMPRESA = E.CODIGOEMPRESA AND ANOMES = E.ANOMES) END) AS VALOR&#13;&#10;FROM EMPRESAS_RESPONSAVEL E, EMPRESAS ES&#13;&#10;WHERE E.CODIGOEMPRESA = ES.CODIGO AND E.CONTABIL = :FUNCIONARIO" PropData="0A506172616D657465727301010CCC000000204E616D653D2246554E43494F4E4152494F222044617461547970653D2200000000150008526561644F6E6C7900104000450000FF450000FF010000000000008000000000160008526571756972656400104000440000FF24FD530001000000000000800100000017000756697369626C6598675300C00000FFC00000FF0100000000000080000000801800084F6E4368616E6765C8675300D00000FFD0222045787072657373696F6E3D225B46554E43494F4E4152494F2E262333343B4150454C49444F262333343B5D220000"/>
    <TfrxButtonControl Name="Button1" Left="40" Top="84" Width="107" Height="33" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="1" ParentFont="False" Caption="&Relatório" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="156" Top="84" Width="107" Height="33" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="1" ParentFont="False" Cancel="True" Caption="&Fechar" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxCheckBoxControl Name="cbValor" Left="8" Top="56" Width="205" Height="17" Font.Charset="0" Font.Color="-2147483640" Font.Height="-13" Font.Name="Courier New" Font.Style="0" ParentFont="False" Caption="Mostrar valores" Color="-2147483633"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="6" RightMargin="6" TopMargin="6" BottomMargin="6" Columns="4" ColumnWidth="71,25" ColumnPositions.Text="0&#13;&#10;71,25&#13;&#10;142,5&#13;&#10;213,75" Bin="65535" BinOtherPages="65535" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="28" Left="-23" Top="57" Width="1071" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="240" ColumnGap="15" DataSet="FUNCIONARIO" DataSetName="FUNCIONARIO" PrintIfDetailEmpty="True" RowCount="0">
      <TfrxMemoView Name="Memo1" Left="2" Top="4" Width="194" Height="24" Color="16739436" Font.Charset="1" Font.Color="16777215" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="13" ParentFont="False" VAlign="vaCenter" Text="[FUNCIONARIO.&#34;APELIDO&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="196" Top="4" Width="61" Height="24" Color="16739436" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="16777215" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="14" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[IF(cbValor.checked = True, 'R$ '+[STR([FUNCIONARIO.&#34;SALARIO&#34;])], '')]"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" Height="17" Left="-23" Top="117" Width="1071" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="240" ColumnGap="15" DataSet="EMPRESA" DataSetName="EMPRESA" RowCount="0">
      <TfrxMemoView Name="edRAZAO" Left="2" Top="0" Width="193" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="13" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[NAMECASE([EMPRESA.&#34;NOMERAZAO&#34;])]"/>
      <TfrxMemoView Name="edANOMES" Left="195" Top="0" Width="20" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="12" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[COPY([EMPRESA.&#34;ANOMES&#34;],6,2)]"/>
      <TfrxMemoView Name="Memo3" Left="215" Top="0" Width="42" Height="17" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="14" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[IF(cbValor.checked = True, [EMPRESA.&#34;VALOR&#34;], '')]"/>
    </TfrxDetailData>
    <TfrxFooter Name="DetailFooter1" Height="25" Left="-23" Top="165" Width="1071">
      <TfrxMemoView Name="Memo4" Left="2" Top="0" Width="213" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="13" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="Soma dos honorÃ¡rios:&#13;&#10;DiferenÃ§a:"/>
      <TfrxMemoView Name="Memo6" Left="215" Top="0" Width="42" Height="25" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="14" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SUM([EMPRESA.&#34;VALOR&#34;])]&#13;&#10;[[SUM([EMPRESA.&#34;VALOR&#34;])] - [FUNCIONARIO.&#34;SALARIO&#34;]]"/>
    </TfrxFooter>
    <TfrxReportTitle Name="ReportTitle1" Height="25" Left="-23" Top="9" Width="1071">
      <TfrxMemoView Name="Memo5" Align="baWidth" Left="2" Top="0" Width="1020" Height="24" Color="16739436" Font.Charset="1" Font.Color="16777215" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[ComboBox1.TEXT]...  ANO..: [EDANO.TEXT]   [IF([[edMes.Text] &#60;&#62; '0'] AND [[edMes.Text] &#60;&#62; '00'], 'MÃS..: '+[EDMES.TEXT], '')]"/>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
